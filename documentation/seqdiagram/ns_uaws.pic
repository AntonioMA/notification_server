.PS
copy "sequence.pic"

#boxwid = 1
movewid = .5

# Object definition
object(WA,"WebApp")
object(UA,"UserAgent")
object(NSUA,"NS-UA")
object(DB,"MongoDB")
object(MB,"M.Broker")
object(AS,"AppServer")
step

message(UA,NSUA,"getToken()")
message(NSUA,NSUA)
return_message(NSUA,UA)
message(NSUA,DB,"st(UAToken,ServerId)")
step

message(WA,UA,"reg('WAToken')")
message(UA,NSUA,"reg_ua('UAToken')")
message(NSUA,NSUA)
message(NSUA,DB,"st(WAToken,UAToken)")
return_message(NSUA,UA,"PublicURI")
return_message(UA,WA,"PublicURI")
message(WA,AS,"PublicURI")

step
step

message(MB,NSUA)
message(NSUA,DB)
return_message(DB,NSUA)
message(NSUA,NSUA)
message(NSUA,UA)
message(UA,WA)

# End diagram
step
complete(WA)
complete(UA)
complete(DB)
complete(MB)
complete(NSUA)
complete(AS)

.PE